[{"content":"1 Shi F, Xin J, Yin P, et al. A GPU accelerated three-dimensional ghost cell method with an improved implicit surface representation for complex rigid or flexible boundary flows[J]. Computer Physics Communications, 2024, 298: 109098.\n2 Lu Y, Wu P, Liu M, et al. A GPU-accelerated 3D ISPH-TLSPH framework for patient-specific simulations of cardiovascular fluid–structure interactions[J]. Computer Methods in Applied Mechanics and Engineering, 2024, 428: 117110.\n3 De Vanna F, Avanzi F, Cogo M, et al. URANOS: A GPU accelerated Navier-Stokes solver for compressible wall-bounded flows[J]. Computer Physics Communications, 2023, 287: 108717.\n4 Yan K. A coupled immersed boundary method and isogeometric shell analysis for fluid–structure interaction of flexible and lightweight shells in high-Reynolds number flows[J]. Computer Methods in Applied Mechanics and Engineering, 2025.\n5 Hierarchical Optimization Time Integration for CFL-Rate MPM Stepping\n6 A Massively Parallel and Scalable Multi-GPU Material Point Method\n其他 11 A conservative and non-dissipative Eulerian formulation for the simulation of soft solids in fluids\n12 A comprehensive and biophysically detailed computational model of the whole human heart electromechanics\nA GPU-accelerated semi-implicit fractional-step method for numerical solutions of incompressible Navier–Stokes equations 15 A Python-based flow solver for numerical simulations using an immersed boundary method on single GPUs\n","date":"2025-04-09T15:53:00+08:00","permalink":"https://hugo.pengfeima.cn/p/paper-writing-1/","title":"流程图和示意图"},{"content":"电话: 15991859247 邮箱: job@pengfeima.cn\n教育背景 2019.9-2025.7 博士研究生，数学，西北工业大学 2018.9-2019.7 硕士研究生，计算数学，西北工业大学 2014.9-2018.7 本科，信息与计算科学，西北工业大学 研究方向 计算力学：流固耦合、纤维增强材料、多孔弹性 科研经历 研究项目：\n国家自然科学基金面上项目（12271440），心肌灌注跨尺度多场耦合建模与计算（2023.1-2026.12） 国家自然科学基金面上项目（11871399），受损心脏电力耦合问题高效数值模拟方法及其应用研究（2019.1-2022.12） 软件开发：\nibfenics：基于 Python3 和 C++ 混合编程的流固耦合软件，基于开源有限元软件 FEniCS 开发，使用 CMake 进行项目管理。(作者) npuheart：异构并行流固耦合软件，初期使用 MPI+CUDA，后期采用 KOKKOS 生成 CUDA 代码。目前支持 CPU 多核和单块 GPU 异构计算。(作者) porosolver：心脏灌注问题的求解软件。(负责数学建模和编程计算。) 代表论文 Pengfei Ma, Li Cai, Xuan Wang, Yongheng Wang, Xiaoyu Luo, Hao Gao. An unconditionally stable scheme for the immersed boundary method with application in cardiac mechanics, Physics of Fluids, 2024, 36: 081914 专业技能 编程语言：C++，Python3，CMake 数值方法：有限元法（FEM），有限差分法（FDM），浸没边界法（IBM）（从零实现并进行并行加速） 并行计算：MPI，CUDA，KOKKOS 其他：linux系统 ","date":"2024-11-19T14:33:22+08:00","permalink":"https://hugo.pengfeima.cn/p/cv/","title":"个人简历"},{"content":"磁盘分区与格式化 使用 parted 工具为新硬盘创建GPT分区表。在 parted 交互式界面中，执行以下命令：\n1 sudo parted /dev/sda 在 parted 交互式界面中，执行以下命令：\n创建GPT分区表： mklabel gpt 创建新分区 mkpart primary ext4 0% 100%\n退出parted\nquit\n格式化分区\n1 sudo mkfs.ext4 /dev/sdb1 磁盘挂载 编辑/etc/fstab\n1 2 /dev/sdb1 /mnt/large0 ext4 defaults 0 2 /dev/sda1 /mnt/large1 ext4 defaults 0 2 查看已经挂载的硬盘 df -h\n共享硬盘 在挂载目录下创建用户目录并修改用户和用户组 1 2 sudo mkdir /mnt/large0/user sudo chown group:user /mnt/large0/user 为当前项目创建文件夹，并创建软连接 1 2 mkdir /mnt/large0/user/project ln -s /mnt/large0/user/project data/large 至此，可以在data/large目录中使用新硬盘\n远程连接 开启smb服务，创建的账号名为smb_user，可以凭此账号通过445端口连接smb远程文件夹。\n1 2 3 4 sudo apt install samba sudo vi /etc/samba/smb.conf sudo smbpasswd -a smb_user sudo systemctl restart smbd 1 2 3 4 5 6 7 8 [shared_1] path = /mnt/large1/user available = yes valid users = smb_user read only = no browsable = yes public = yes writable = yes 需要注意权限，smb_user只给user使用，因为smb_user账号可以修改目录/mnt/large1/user下所有文件。\n路径//10.70.181.65/shared_1可以连接上用户/mnt/large1/user文件夹，\n","date":"2024-10-16T14:33:27+08:00","permalink":"https://hugo.pengfeima.cn/p/initial-new-disk/","title":"Linux系统中新磁盘的分区与格式化"},{"content":"https://wangxuan.mapengfei.cn/web\n","date":"2024-09-29T02:22:22Z","permalink":"https://hugo.pengfeima.cn/p/.name/","title":"流固耦合算例(WIP)"},{"content":"二维解析解 $$ \\Omega=[ 0, 1 ] \\times[ 0, 1 ], \\, \\mathrm{T}=0. 1 \\mathrm{s}, $$$$ \\left\\{\\begin{array} {l} {{{u_{1} ( x, y, t )=-\\operatorname{e x p} ( t ) x^{2} ( x-1 )^{2} y ( y-1 ) ( 2 y-1 ) / 2 5 6}}} \\\\ {{{u_{2} ( x, y, t )=\\operatorname{e x p} ( t ) x ( x-1 ) ( 2 x-1 ) y^{2} ( y-1 )^{2} / 2 5 6}}} \\\\ {{{p ( x, y, t )=\\operatorname{e x p} ( t ) ( x^{3}-1 / 4 )}}} \\\\ \\end{array} \\right. $$ $$ \\Omega=[0,1] \\times[0,1], \\mathrm{T}=0.1 \\mathrm{~s}, $$$$ \\begin{aligned} \u0026 \\qquad\\left\\{\\begin{array}{l} u_1(x, y, t)=\\exp (t) \\sin ^2(\\pi x) \\sin (2 \\pi y) \\\\ u_2(x, y, t)=-\\exp (t) \\sin (2 \\pi x) \\sin ^2(\\pi y) \\\\ p(x, y, t)=\\exp (t)(\\sin (\\pi y)-2 / \\pi) \\end{array}\\right. \\end{aligned} $$ $$ \\Omega=[0,1] \\times[0,1], \\mathrm{T}=0.1 \\mathrm{~s} $$$$ \\begin{aligned} \\qquad\\left\\{\\begin{array}{l} u_1(x, y, t)=20 x^2(x-1)^2 y(y-1)(2 y-1) t \\\\ u_2(x, y, t)=-20 x(x-1)(2 x-1) y^2(y-1)^2 t \\\\ p(x, y, t)=10(2 x-1)(2 y-1) \\end{array}\\right. \\end{aligned} $$ $$ \\Omega=[0,1] \\times[0,1], \\mathrm{T}=0.1 \\mathrm{~s} $$$$ \\begin{aligned} \u0026 \\qquad\\left\\{\\begin{array}{l} u_1(x, y, t)=20 x^2(x-1)^2 y(y-1)(2 y-1) t \\\\ u_2(x, y, t)=-20 x(x-1)(2 x-1) y^2(y-1)^2 t \\\\ p(x, y, t)=10(2 x-1)(2 y-1) t \\end{array}\\right. \\end{aligned} $$ $$ \\Omega=[0,1] \\times[0,1], \\mathrm{T}=0.1 \\mathrm{~s} $$$$ \\begin{aligned} \\qquad\\left\\{\\begin{array}{l} u_1(x, y, t)=2 \\pi \\sin ^2(\\pi x) \\sin (\\pi y) \\cos (\\pi y) \\cos (t) \\\\ u_2(x, y, t)=-2 \\pi \\sin (\\pi x) \\cos (\\pi x) \\sin ^2(\\pi y) \\cos (t) \\\\ p(x, y, t)=\\cos (\\pi x) \\cos (\\pi y) \\end{array}\\right. \\end{aligned} $$ [p. 389.] 1 $$ \\begin{aligned} \u0026 u=\\left[\\begin{array}{c} \\sin (4 \\pi x) \\cos (4 \\pi y) \\\\ -\\cos (4 \\pi x) \\sin (4 \\pi y) \\end{array}\\right] \\\\ \u0026 p=\\pi \\cos (4 \\pi x) \\cos (4 \\pi y) \\end{aligned} $$ Taylor–Green vortex2 $$ \\Omega=[-1,1] \\times[-1,1], \\mathrm{T}=0.5, \\nu=0.01 $$ $$ \\begin{aligned} \u0026 u(x, y, t)=\\left(\\cos (\\pi x) \\sin (\\pi y) e^{-2 t v \\pi^2}, \\cos (\\pi y) \\sin (\\pi x) e^{-2 t v \\pi^2}\\right) \\\\ \u0026 p(x, y, t)=-0.25(\\cos (2 \\pi x)+\\cos (2 \\pi y)) e^{-4 t v \\pi^2} \\end{aligned} $$ $$ \\Omega=[0,2] \\times[-1,1], \\mathrm{T}=0.1, \\mu=0.01 . $$$$ \\begin{aligned} \u0026 \\qquad\\left\\{\\begin{array}{l} u=2 \\cos (\\pi y) \\sin (\\pi x) \\sin t \\\\ v=-2 \\sin (\\pi y) \\cos (\\pi x) \\sin t \\\\ p=2 \\sin (\\pi y) \\sin (\\pi x) \\cos t \\end{array}\\right. \\end{aligned} $$ $$ \\Omega=[0,1] \\times[-0.25,0], \\mathrm{T}=0.1 \\mathrm{~s} $$$$ \\begin{aligned} \u0026 \\qquad\\left\\{\\begin{array}{l} u_1=\\left(x^2 y^2+e^{-y}\\right) \\cos (2 \\pi t) \\\\ u_2=\\left[-\\frac{2}{3} x y^3+2-\\pi \\sin (\\pi x)\\right] \\cos (2 \\pi t) \\\\ p=-[2-\\pi \\sin (\\pi x)] \\cos (2 \\pi y) \\cos (2 \\pi t) \\end{array}\\right. \\end{aligned} $$ $$ \\begin{aligned} \u0026u_{1}=\\left(x^{2} y^{2}+e^{-y}\\right) \\cos (2 \\pi t) \\\\ \u0026u_{2}=\\left[-\\frac{2}{3} x y^{3}+2-\\pi \\sin (\\pi x)\\right] \\cos (2 \\pi t) \\\\ \u0026p=-[2-\\pi \\sin (\\pi x)] \\cos (2 \\pi y) \\cos (2 \\pi t) \\end{aligned} $$ Kovasznay flow 3, 用于验证SAV方法的无条件能量稳定 $$ \\left\\{\\begin{array}{l} u=1-e^{\\lambda x} \\cos (2 \\pi y) \\\\ v=\\frac{\\lambda}{2 \\pi} e^{\\lambda x} \\sin (2 \\pi y) \\\\ p=\\frac{1}{2}\\left(1-e^{2 \\lambda x}\\right) \\end{array}\\right. $$三维解析解 $$ \\begin{aligned} p(x) \u0026=\\cos \\left(\\pi x_{1}\\right) \\cos \\left(\\pi x_{2}\\right) \\cos \\left(\\pi x_{3}\\right), \\\\ u_{1}(x) \u0026=\\pi^{2}\\left(\\sin \\left(\\pi x_{1}\\right)\\right)^{2} \\sin \\left(2 \\pi x_{2}\\right) \\sin \\left(2 \\pi x_{3}\\right), \\\\ u_{2}(x) \u0026=-0.5 \\pi^{2} \\sin \\left(2 \\pi x_{1}\\right)\\left(\\sin \\left(2 \\pi x_{2}\\right)\\right)^{2} \\sin \\left(\\pi x_{3}\\right), \\\\ u_{3}(x) \u0026=-0.5 \\pi^{2} \\sin \\left(2 \\pi x_{1}\\right) \\sin \\left(2 \\pi x_{2}\\right)\\left(\\sin \\left(\\pi x_{3}\\right)\\right)^{2} . \\end{aligned} $$ $$ \\begin{aligned} \u0026\\left.\\boldsymbol{u}=\\left(y^{4}+z^{2}\\right) e^{-t},\\left(z^{4}+x^{2}\\right) e^{-t},\\left(x^{4}+y^{2}\\right) e^{-t}\\right) . \\\\ \u0026p=(2 x-1)(2 y-1)(2 z-1) e^{-t}, \\end{aligned} $$ Beltrami flow4，由 Ethier 和 Steinmann 于1994年提出，计算区域为 [-1,1]x[-1,1]x[-1,1] ，它速度和压强的精确解为 $$ \\begin{aligned} \u0026u(x, y, z, t)=-a\\left[e^{a x} \\sin (a y+d z)+e^{a z} \\cos (a x+d y)\\right] e^{-d^{2} t} \\\\ \u0026v(x, y, z, t)=-a\\left[e^{a y} \\sin (a z+d x)+e^{a x} \\cos (a y+d z)\\right] e^{-d^{2} t} \\\\ \u0026w(x, y, z, t)=-a\\left[e^{a z} \\sin (a x+d y)+e^{a y} \\cos (a z+d x)\\right] e^{-d^{2} t} \\end{aligned} $$$$ \\begin{aligned} p(x, y, z, t)=-a^{2} e^{-2 d^{2} t}\\left(e^{2 a x}+e^{2 a y}+e^{2 a z}\\right)(\u0026 \\sin (a x+d y) \\cos (a z+d x) e^{a(y+z)} \\\\ \u0026\\left.+\\sin (a y+d z) \\cos (a x+d y) e^{a(x+z)}+\\sin (a z+d x) \\cos (a y+d z) e^{a(x+y)}\\right) \\end{aligned} $$泊肃叶流(WIP) 方腔驱动流(WIP) 圆柱绕流(WIP) [Automated Solution of Differential Equations by the Finite Element Method. p. 389.]\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n[Automated Solution of Differential Equations by the Finite Element Method. Chapter. 21.4.4]\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nNumerical approximation of incompressible Navier-Stokes equations based on an auxiliary energy variable\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n[Automated Solution of Differential Equations by the Finite Element Method. Chapter. 21.4.6]\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2024-09-28T22:42:25Z","permalink":"https://hugo.pengfeima.cn/p/navier-stokes-demos/","title":"Navier Stokes 算例"},{"content":"虚功原理 Principle of Virtual Work $\\delta \\boldsymbol{v}$ 虚速度(virtual velocity) $\\boldsymbol{r}$ 残余力(residual force) $\\delta \\boldsymbol{l}$ 虚速度梯度 the virtual velocity gradient $\\boldsymbol{t}$ traction vector 虚功(virtual work): $\\delta w$, 单位体积单位时间内，虚运动过程中残余力(residual force)的做功为零。\n$$ \\delta w=\\boldsymbol{r}\\cdot\\delta\\boldsymbol{v}=0 $$由于$\\delta \\boldsymbol{v}$ 的任意性，上述式子等价于$\\boldsymbol{r}=0$\n物体的静态平衡方程的弱形式为\n$$ \\delta W=\\int_v(\\operatorname{div} \\boldsymbol{\\sigma}+\\boldsymbol{f}) \\cdot \\delta \\boldsymbol{v} d v=0 $$根据 $\\text{div}$ 算子的性质\n$$ \\operatorname{div}(\\boldsymbol{\\sigma} \\delta \\boldsymbol{v})=(\\operatorname{div} \\boldsymbol{\\sigma}) \\cdot \\delta \\boldsymbol{v}+\\boldsymbol{\\sigma}: \\boldsymbol{\\nabla} \\delta \\boldsymbol{v} $$以及高斯定理, 可以得到\n$$ \\int_{\\partial v} \\boldsymbol{n} \\cdot \\boldsymbol{\\sigma} \\delta \\boldsymbol{v} d a-\\int_v \\boldsymbol{\\sigma}: \\boldsymbol{\\nabla} \\delta \\boldsymbol{v} d v+\\int_v \\boldsymbol{f} \\cdot \\delta \\boldsymbol{v} d v=0 $$$$ \\boldsymbol{t}(\\boldsymbol{n})=\\boldsymbol{\\sigma} \\boldsymbol{n} ; \\quad \\boldsymbol{\\sigma}=\\sum_{i, j=1}^3 \\sigma_{i j} \\boldsymbol{e}_i \\otimes \\boldsymbol{e}_j $$$$ \\int_v \\boldsymbol{\\sigma}: \\delta \\boldsymbol{l} d v=\\int_v \\boldsymbol{f} \\cdot \\delta \\boldsymbol{v} d v+\\int_{\\partial v} \\boldsymbol{t} \\cdot \\delta \\boldsymbol{v} d a $$$$ \\delta W=\\int_v \\boldsymbol{\\sigma}: \\delta \\boldsymbol{d} d v-\\int_v \\boldsymbol{f} \\cdot \\delta \\boldsymbol{v} d v-\\int_{\\partial v} \\boldsymbol{t} \\cdot \\delta \\boldsymbol{v} d a=0 $$ spatial virtual work equation，是一个标量方程，描述了形变物体的平衡状态，有限元离散的基础。\n功的共轭性 $$ \\begin{equation} \\delta W_{\\mathrm{int}}=\\int_v \\boldsymbol{\\sigma}: \\delta \\boldsymbol{d} d v \\end{equation} $$ $\\boldsymbol{\\sigma}$ 和 $\\boldsymbol{d}$ 是共轭(work conjugate)的，关于当前形变体积，它们的内积得到单位当前体积做的功。\nmaterial coordinate\n$$ \\begin{equation} \\delta W_{\\mathrm{int}}=\\int_V \\boldsymbol{\\tau}: \\delta \\boldsymbol{d} d V ; \\quad \\boldsymbol{\\tau}=J \\boldsymbol{\\sigma} \\end{equation} $$$$ \\begin{equation} \\begin{aligned} \\delta W_{\\mathrm{int}} \u0026 =\\int_V J \\boldsymbol{\\sigma}: \\delta \\boldsymbol{l} d V \\\\ \u0026 =\\int_V J \\boldsymbol{\\sigma}:\\left(\\delta \\dot{\\boldsymbol{F}} \\boldsymbol{F}^{-1}\\right) d V \\\\ \u0026 =\\int_V \\operatorname{tr}\\left(J \\boldsymbol{F}^{-1} \\boldsymbol{\\sigma} \\delta \\dot{\\boldsymbol{F}}\\right) d V \\\\ \u0026 =\\int_V\\left(J \\boldsymbol{\\sigma} \\boldsymbol{F}^{-T}\\right): \\delta \\dot{\\boldsymbol{F}} d V \\end{aligned} \\end{equation} $$这两者在虚功的意义下是相等的。\n$$ -\\frac{\\partial \\Psi}{\\partial \\boldsymbol{X}}\\cdot \\delta\\boldsymbol{v} $$$$ F = \\nabla\\cdot\\mathbb{P}? $$$$ \\boldsymbol{F}=-\\frac{\\partial \\Psi(\\mathbb{F}(\\boldsymbol{X}),\\boldsymbol{X})}{\\partial \\boldsymbol{X}}=-\\frac{\\partial \\Psi}{\\partial \\mathbb{F}}\\frac{\\partial \\mathbb{F}}{\\partial \\boldsymbol{X}}=-\\mathbb{P}\\frac{\\partial F}{\\partial \\boldsymbol{X}} $$Kirchhoff 应力张量 称 $\\sigma$ 和 $\\boldsymbol{d}$ 为work conjugate\n该方程中的σ和d等对被称为与电流变形体积的功共轭，因为它们的乘积给出了单位电流体积的功。\nhugo new \u0026ndash;kind post-bundle post/virtual-work-principle\n达朗贝尔原理 （D\u0026rsquo;Alembert\u0026rsquo;s principle）\n总势能函数和平衡状态 总势能泛函为:\n$$ \\Pi(\\boldsymbol{\\phi})=\\int_V \\Psi(\\boldsymbol{C}) d V-\\int_V \\boldsymbol{f}_0 \\cdot \\boldsymbol{\\phi} d V-\\int_{\\partial V} \\boldsymbol{t}_0 \\cdot \\boldsymbol{\\phi} d A , $$其方向导数产生虚功原理\n$$ \\begin{aligned} D \\Pi(\\phi)[\\delta \\boldsymbol{v}] \u0026 =\\int_V \\frac{\\partial \\Psi}{\\partial \\boldsymbol{C}}: D \\boldsymbol{C}[\\delta \\boldsymbol{v}] d V-\\int_V \\boldsymbol{f}_0 \\cdot \\delta \\boldsymbol{v} d V-\\int_{\\partial V} \\boldsymbol{t}_0 \\cdot \\delta \\boldsymbol{v} d A \\\\ \u0026 =\\int_V \\boldsymbol{S}: D \\boldsymbol{E}[\\delta \\boldsymbol{v}] d V-\\int_V \\boldsymbol{f}_0 \\cdot \\delta \\boldsymbol{v} d V-\\int_{\\partial V} \\boldsymbol{t}_0 \\cdot \\delta \\boldsymbol{v} d A=0 \\end{aligned} $$(p. 225.):\n","date":"2024-09-27T14:18:45Z","permalink":"https://hugo.pengfeima.cn/p/virtual-work-principle/","title":"虚功原理"},{"content":" 更新形变梯度 $$ \\mathbf{v}(\\mathbf{x},t)=\\mathbf{V}\\left(\\chi^{-1}\\left(\\mathbf{x}, \\mathrm{t}\\right), \\mathrm{t}\\right) \\tag{1} $$$$ \\mathbf{v}\\left(\\chi\\left(\\mathbf{X}, \\mathrm{t}\\right),t\\right)=\\mathbf{V}\\left(\\mathbf{X}, \\mathrm{t}\\right) \\tag{2} $$$$ \\frac{\\partial}{\\partial t} \\mathbb{F}\\left(\\mathbf{X}, t\\right)=\\nabla_{\\mathbf{X}}\\mathbf{V}\\left(\\mathbf{X}, t\\right)=\\nabla_\\mathbf{x} \\mathbf{v}(\\mathbf{x},t)\\mathbb{F}\\left(\\mathbf{X}, t\\right) . $$$$ \\frac{\\partial}{\\partial t} \\mathbb{F}\\left(\\mathbf{X}, t_{n+1}\\right)=\\nabla_\\mathbf{x} \\mathbf{v}(\\chi\\left(\\mathbf{X}, \\mathrm{t}_{n}\\right),t_{n+1})\\mathbb{F}\\left(\\mathbf{X}, t_{n}\\right) .\\tag{6} $$$$ \\frac{\\partial}{\\partial t} \\mathbb{F}\\left(\\mathbf{X}, t^{n+1}\\right) \\approx \\frac{\\mathbb{F}^{n+1}-\\mathbb{F}^n}{\\Delta t} $$$$ F_p^{n+1}=F_p^n+\\Delta t \\frac{\\partial v^{n+1}}{\\partial x}\\left(x_p^n\\right) F_p^n=\\left(I+\\Delta t \\frac{\\partial v^{n+1}}{\\partial x}\\left(x_p^n\\right)\\right) F_p^n $$$$ \\begin{aligned} v^{n+1}(x) \u0026 =\\sum_i v_i^{n+1} N_i(x) \\\\ \\frac{\\partial v^{n+1}}{\\partial x}(x) \u0026 =\\sum_i v_i^{n+1}\\left(\\frac{\\partial N_i}{\\partial x}(x)\\right)^{\\top} \\end{aligned} $$then we have\n$$ F_p^{n+1}=\\left(I+\\Delta t \\sum_i v_i^{n+1}\\left(\\frac{\\partial N_i}{\\partial x}\\left(x_p^n\\right)\\right)^{\\top}\\right) F_p^n $$as the update rule for ${F_p^{\\mathfrak{p}}}^{n+1}$ given the $v_i^{n+1}$ and $F_{\\mathfrak{p}}^n$.\n更新位移 更新力 Symplectic Euler MPM\n计算$m_i^n$和$\\mathbf{v}^n_i$\n计算出力源项$\\mathbf{f}_i^n$\n更新速度$\\mathbf{v}^{n+1}_i$\n更新形变梯度$\\mathbb{F}_p^{n+1}$\n更新速度$\\mathbf{v}_p^{n+1}$和$\\mathbf{x}_p^{n+1}$\n$$ \\mathbf{X}_i=\\chi^{-1}(\\mathbf{x}_i,t) $$ $\\mathbf{x}_i^{n+1}$ 为此拉格朗日点下一时刻的坐标。\n获取网格上的速度 (与浸没边界法类似)\n更新力 $$ \\begin{equation} f_i(\\boldsymbol{x})=-\\frac{\\partial e}{\\partial x_i}(\\boldsymbol{x})=-\\sum_p V_p^0\\left(\\frac{\\partial \\Psi_p}{\\partial F}\\left(F_p(x)\\right)\\right)\\left(F_p^n\\right)^{\\top} \\nabla w_{i p}^n . \\end{equation} $$$$ \\begin{equation} f_i^n=f_i\\left(x_i^n\\right)=-\\sum_p V_p^0\\left(\\frac{\\partial \\Psi_p}{\\partial F}\\left(F_p^n\\right)\\right)\\left(F_p^n\\right)^{\\top} \\nabla w_{i p}^n, \\end{equation} $$更新速度 更新形变梯度 $$ \\begin{equation} F_p^{n+1}=\\left(I+\\Delta t \\sum_i v_i^{n+1}\\left(\\nabla w_{i p}^n\\right)^{\\top}\\right) F_p^n \\end{equation} $$如果我们想要给出一个类似的定义，我们可以定义一个张量场 \\(\\Psi\\) 对另一个张量场 \\(\\mathbb{F}\\) 的变化率的散度。在数学上，这可以表示为：\n$$ \\nabla \\cdot (\\Psi \\cdot \\nabla \\mathbb{F} $$ 这里，\\(\\nabla \\cdot\\) 表示散度算子，\\(\\Psi\\) 是一个张量场，\\(\\nabla \\mathbb{F}\\) 表示张量场 \\(\\mathbb{F}\\) 的梯度，而 \\(\\cdot\\) 表示张量乘积。\n然而，这个表达式与原始问题中的表达式仍然不同，因为原始问题中的表达式是：\n\\[ \\nabla \\cdot \\left( \\frac{\\partial \\Psi}{\\partial \\mathbb{F}} \\right) \\]这表示张量场 \\(\\Psi\\) 对张量场 \\(\\mathbb{F}\\) 的偏导数的散度。\n如果我们想要定义一个与原始表达式类似的表达式，我们可以考虑定义张量场 \\(\\Psi\\) 对张量场 \\(\\mathbb{F}\\) 的偏导数的散度，并且乘以张量场 \\(\\mathbb{F}\\) 对空间坐标 \\(x\\) 的偏导数，可以表示为：\n\\[ \\nabla \\cdot \\left( \\frac{\\partial \\Psi}{\\partial \\mathbb{F}} \\cdot \\frac{\\partial \\mathbb{F}}{\\partial x} \\right) \\]这个表达式表示的是张量场 \\(\\Psi\\) 对张量场 \\(\\mathbb{F}\\) 的偏导数与张量场 \\(\\mathbb{F}\\) 对空间坐标 \\(x\\) 的偏导数的乘积的散度。这与原始表达式不同，因为它包含了散度算子和乘积。\n","date":"2024-09-26T15:00:00Z","permalink":"https://hugo.pengfeima.cn/p/material-point-method/","title":"物质点方法"},{"content":"https://www.bilibili.com/video/BV1ft421b7iW/?spm_id_from=333.337.search-card.all.click\u0026vd_source=5abfb7c63abd04e3e543a6829e7d3578\n","date":"2024-09-24T00:00:00Z","image":"https://hugo.pengfeima.cn/p/paraview-plot-q-criterion/2153815980797591552_hu_61e6d6200e0ad9ff.jpeg","permalink":"https://hugo.pengfeima.cn/p/paraview-plot-q-criterion/","title":"Q准则涡"},{"content":"浏览量： 评论数：\n需要画流体的流线图和固体的形变图。 流线图用 Mask Points 和 Stream Tracer With Custom Source 绘制, 这两个 Filter 的使用可以参考画双心室的纤维图。形变图用 Warp By Vector 绘制。\n导入流体和固体的数据 计算固体形变 WIP：下面这些图的教程 速度等高图 下载数据: paraview-fsi-plot.001.zip\n","date":"2024-09-24T00:00:00Z","image":"https://hugo.pengfeima.cn/p/paraview-plot-deformation/2153815980797591552_hu_61e6d6200e0ad9ff.jpeg","permalink":"https://hugo.pengfeima.cn/p/paraview-plot-deformation/","title":"流固耦合运动绘图"},{"content":" paraview 输出 png 格式文件, 背景为透明色，更方便修改\n画二维截面的流线图\n修改图例\n流固耦合算例(一)\n流固耦合算例(二)\n流固耦合算例(三)\n","date":"2024-09-23T00:00:00Z","image":"https://hugo.pengfeima.cn/p/paraview-toc/2153815987617529856_hu_cd2766bd19985cfc.jpeg","permalink":"https://hugo.pengfeima.cn/p/paraview-toc/","title":"Paraview 目录"},{"content":"浏览量：加载中\u0026hellip;\n评论数：加载中\u0026hellip;\n打开文件 Filters -\u0026gt; Search -\u0026gt; Mask Points 选择 Mask Points, 修改数量 Filters -\u0026gt; Search -\u0026gt; Stream Tracer With Custom Source f0 作为输入数据 MaskPoints1 作为采样点 Streamline 修改 Tube1 的宽度 减少 Tube1 的数量 下载数据: ventricle-mesh.zip\n","date":"2024-09-23T00:00:00Z","image":"https://hugo.pengfeima.cn/p/paraview-plot-streamline/2153816028738486272_hu_12228605177cbd0d.jpeg","permalink":"https://hugo.pengfeima.cn/p/paraview-plot-streamline/","title":"画双心室的纤维图"},{"content":"插入图像可以使用三种 shortcodes, 分别是:\n单幅居中 单行多幅等高排列 瀑布流的相册 单幅居中 1 { {\u0026lt; myfigure src=\u0026#34;/p/image-gallery/2153815980856311808.jpeg\u0026#34; title=\u0026#34;Image 1\u0026#34; percent=\u0026#34;60%\u0026#34;\u0026gt;} } Image 1 等高排列 Stack 自带语法，参考了 Typlog, 使用了 PhotoSwipe. 只支持本地图片，高度固定.\n渼陂湖 瀑布流 参考：Sulv\u0026rsquo;s Blog\n\u003c!DOCTYPE html\u003e 壁纸 香克斯 香克斯 香克斯 香克斯 ","date":"2023-08-26T00:00:01Z","image":"https://hugo.pengfeima.cn/p/image-gallery/2153815980856311808_hu_d1bc0f2cebf526bb.jpeg","permalink":"https://hugo.pengfeima.cn/p/image-gallery/","title":"相册"},{"content":" 购车经验 我购买的秦PLUS为 2023款 冠军版 DM-i 120KM领先型，裸车价格125800元，西安造字台附近的比亚迪新景腾飞4S店购买，价格无优惠。\n销售通过易车APP获取我的电话，于6月30号上午给我打电话。销售告诉我，这个月月底冲业绩，今天购车可送我八次保养，免上牌费，送底盘装甲，可当天提车。下午我和WX就去他们店里看车，结果销售说上牌费不能免。我想提车，不想再到处跑，折腾购车相关的事情，没有去其他4S店看车，就付钱提车了。\n以后可能还会买车，需要注意的点：\n贴膜。原厂送的膜质量很差，如果想换膜，可以在买车前跟销售谈换膜的价格，别贴膜的时候被忽悠到交钱了。我去贴膜的时候被告知，换成康得新膜或者龙膜要一千多，我没有掏钱，只贴了原厂送的膜。 保险。4S店里卖保险的人介绍保险的时候，将出行险和座位险混为一谈，声称能保62万。事实上，62万中的60万属于车主的出行险，价格715元，只保车主不保乘客。销售还推荐了一个不知名的险种，能够放大赔偿金额，没必要购买。 延保。花三千多延长保修到8年，与机械部件不同，电子元器件的故障率随着使用年限增长而降低，有问题的部件会在保修期内损坏坏，保修期内没坏的大概率能使用到汽车报废。 价格。现在汽车价格公开透明，但8月份是汽车销售淡季，汽车的资金占用成本和库存成本很高，降价是必然的。我买的这款车并不缺现车，我提的车为三月份生产，六月底卖出，期间存放了三个多月。如果在8月18日购车，会有3000元购车优惠，950元交强险优惠。 总之，一定要有耐心，一定要把各个事项问清楚，慎重交款，交款之前主动权还是在自己这边的，交款之后再谈会很被动。交钱后发现保险和销售说的不一样，可以退保。\n我决定购买这辆车时，已接受了它的缺点：\n底盘硬，走烂路不舒服 在易车十万里长测中能看到，保险杠连接处会生锈 长城举报比亚迪没有使用高压油箱，蒸发不达标 EV受限，不能长期亏电行驶 以后有钱了要买安全系数高的车，非承载车身，吨位大，新，铝合金/热处理钢，防撞梁高度高，抗翻滚能力高。\n赠品 八次保养(约¥200/次) 贴膜(约¥1000) 底盘装甲(约¥1000) 赠品总价值约为 ¥3600。贴膜的时候原厂贴膜可以换成康得新膜或者龙膜，抵掉原厂送的贴膜，需要加价一千多。 其他消费 上牌费(¥500) 行车记录仪(¥303) 后备箱垫(¥50还没买) 放电枪(¥333) 抱枕(¥80) 总共 ¥1783 保险 交强险 950 车辆损失险 2600 第三方200万 950 乘客2万 55 司机2万 22 出行险 715 总共 ¥ 5361，以后可以免去或减少出行险的保额。 轮胎型号 原厂轮胎为佳通 215/55 R17 94V F22，换过一个轮胎，总共¥480。 补胎: 蘑菇钉，60元，忘了叫他给轮胎做动平衡。\n购物清单 车载吸尘器(¥199)\n无线洗车机机(¥369)\n玻璃水\n户外桌椅(¥104)\n天幕帐篷(¥105)\n防潮垫\n吊床(¥39)\n","date":"2023-08-18T08:49:21Z","image":"https://hugo.pengfeima.cn/p/aaaaa/WechatIMG415_hu_b69fe4bafb7d999d.jpg","permalink":"https://hugo.pengfeima.cn/p/aaaaa/","title":"秦PLUS日常使用油电消耗统计"}]